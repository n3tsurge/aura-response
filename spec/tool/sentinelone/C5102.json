{
    "id": "T0001.C5102",
    "ref": "tool:sentinelone:recover:restore-system-from-backup",
    "author": "n3tsurge",
    "created_on": "2025-07-15",
    "description": "This tool capability allows stakeholders to restore systems from backup using SentinelOne's Rollback Engine and system recovery features. It provides comprehensive system restoration capabilities for rapid recovery from security incidents.\n\n## Workflow\n\n### How to Restore System from Backup via SentinelOne Console (GUI)\n\n1. **Log into the SentinelOne Management Console.**\n2. Navigate to **'Threats'** to identify threats requiring system restoration.\n3. Assess the scope of system compromise:\n   - Review threat timeline and affected files\n   - Analyze system changes and modifications\n   - Determine restoration point requirements\n4. Use **'Rollback Engine'** for automated restoration:\n   - Navigate to threat details\n   - Select **'Rollback'** action\n   - Choose restoration scope:\n     - **File System Rollback**: Restore modified/deleted files\n     - **Registry Rollback**: Restore registry changes\n     - **Process Rollback**: Terminate malicious processes\n5. For manual system analysis and restoration:\n   - Navigate to **'Deep Visibility'** for forensic review\n   - Use **'Event Search'** to identify system changes:\n     ```\n     event.type = 'File Modification' and tgt.file.path contains 'C:\\Windows'\n     event.type = 'Registry Value Set' and tgt.registry.path contains 'HKLM'\n     event.type = 'Service Install' and src.process.name != 'services.exe'\n     ```\n6. Coordinate with backup systems:\n   - Export affected file lists from SentinelOne\n   - Identify backup restoration requirements\n   - Plan restoration sequence and dependencies\n7. Monitor restoration progress and verify system integrity.\n8. Validate system functionality post-restoration.\n\n### Using SentinelOne API for System Restoration\n\n```bash\n# Initiate automatic rollback\ncurl -X POST \"https://[console].sentinelone.net/web/api/v2.1/threats/actions/rollback\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"filter\": {\n      \"ids\": [\"threat-id-here\"]\n    },\n    \"data\": {\n      \"rollbackType\": \"full\"\n    }\n  }'\n\n# Get rollback status\ncurl -X GET \"https://[console].sentinelone.net/web/api/v2.1/activities\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -G -d \"activityTypes=23\" \\\n  -d \"agentIds=agent-id-here\"\n```\n\n### PowerQuery for System Change Analysis\n\n```sql\n# Identify all system modifications for restoration planning\nevent.type in ('File Modification', 'File Creation', 'File Deletion') and (tgt.file.path contains 'C:\\Windows' or tgt.file.path contains 'C:\\Program Files') | group ChangeCount = count() by event.type, src.process.name | sort -ChangeCount\n```\n\n### Registry Change Analysis for Restoration\n\n```sql\n# Analyze registry modifications requiring restoration\nevent.type in ('Registry Key Create', 'Registry Value Set', 'Registry Key Delete') and (tgt.registry.path contains 'HKLM' or tgt.registry.path contains 'HKCU') and src.process.name not in ('svchost.exe', 'winlogon.exe') | project event.time, event.type, tgt.registry.path, tgt.registry.value, src.process.name\n```\n\n### Service and Startup Item Analysis\n\n```sql\n# Identify unauthorized service installations\nevent.type = 'Service Install' and src.process.name not in ('services.exe', 'sc.exe') | project event.time, service.name, service.path, src.process.name, src.process.user\n\n# Monitor startup item modifications\nevent.type = 'Registry Value Set' and tgt.registry.path contains 'Run' | project event.time, tgt.registry.path, tgt.registry.value, src.process.name\n```\n\n### Post-Restoration Verification\n\n```sql\n# Verify system restoration success\nevent.type = 'Rollback Complete' and rollback.status = 'Success' | group RestorationCount = count() by rollback.type, agent.name | sort -RestorationCount\n\n# Monitor for re-infection after restoration\nevent.type = 'Threat Detection' and event.time > 'restoration-time' | project threat.name, threat.type, agent.name, event.time\n```\n\n### Integration with External Backup Systems\n\n```bash\n# Export affected file list for external backup restoration\ncurl -X GET \"https://[console].sentinelone.net/web/api/v2.1/cloud-funnel/events\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -G -d \"query=event.type = 'File Modification' and tgt.file.path contains 'C:\\Users'\" \\\n  -d \"limit=10000\" | jq '.data[].tgt.file.path' > affected_files.txt\n```\n\nThis provides comprehensive system restoration capabilities using SentinelOne's Rollback Engine and S1QL 2.0 query language for rapid recovery from security incidents.",
    "friendly_name": "sentinelone-restore-system-from-backup",
    "title": "Restore System from Backup",
    "unique_id": "f6g7h8i9-j0k1-2345-fghi-123456789018"
}

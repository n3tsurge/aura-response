{
    "id": "T0001.C2101",
    "ref": "tool:sentinelone:identify:list-running-processes",
    "author": "n3tsurge",
    "created_on": "2025-07-15",
    "description": "This tool capability allows stakeholders to identify and list running processes using SentinelOne's Deep Visibility and Event Search features. It provides comprehensive process monitoring and analysis capabilities for threat hunting.\n\n## Workflow\n\n### How to List Running Processes via SentinelOne Console (GUI)\n\n1. **Log into the SentinelOne Management Console.**\n2. Navigate to **'Event Search'** in the sidebar.\n3. Use the **EDR** view for real-time process analysis.\n4. Configure search queries to list running processes:\n   ```\n   event.type = 'Process Creation'\n   event.type = 'Process Creation' and src.process.name contains 'powershell'\n   event.type = 'Process Creation' and src.process.user = 'SYSTEM'\n   ```\n5. Navigate to **'Deep Visibility'** for live process investigation:\n   - Select target endpoint(s)\n   - Use **'Processes'** view for real-time process list\n   - Apply filters for specific process criteria\n6. Analyze process data including:\n   - `src.process.name` - process executable name\n   - `src.process.user` - user context\n   - `src.process.pid` - process ID\n   - `src.process.cmdLine` - command line arguments\n   - `src.process.parent.name` - parent process\n   - `src.process.startTime` - process start time\n   - `src.process.imagePath` - full executable path\n7. Use **PowerQuery** for advanced process analysis:\n   ```\n   event.type = 'Process Creation' | group ProcessCount = count() by src.process.name, src.process.user | sort -ProcessCount\n   ```\n8. Export results for further analysis and documentation.\n\n### Using SentinelOne API for Process Enumeration\n\n```bash\n# Query process creation events via API\ncurl -X GET \"https://[console].sentinelone.net/web/api/v2.1/cloud-funnel/events\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -G -d \"query=event.type = 'Process Creation'\" \\\n  -d \"limit=1000\"\n\n# Get live processes from specific agent\ncurl -X GET \"https://[console].sentinelone.net/web/api/v2.1/agents/[agent-id]/processes\" \\\n  -H \"Authorization: ApiToken [your-token]\"\n```\n\n### PowerQuery for Advanced Process Analysis\n\n```sql\nevent.type = 'Process Creation' | group ProcessCount = count(), UniqueUsers = estimate_distinct(src.process.user) by src.process.name | filter ProcessCount > 100 or UniqueUsers > 10 | sort -ProcessCount\n```\n\n### Deep Visibility Process Investigation\n\n```sql\nevent.type = 'Process Creation' and (src.process.name contains 'cmd' or src.process.name contains 'powershell') and (src.process.cmdLine contains 'encoded' or src.process.cmdLine contains 'base64') | project src.process.name, src.process.user, src.process.cmdLine, src.process.parent.name\n```\n\nThis provides comprehensive process visibility using SentinelOne's S1QL 2.0 query language for threat hunting and system analysis.",
    "friendly_name": "sentinelone-list-running-processes",
    "title": "List Running Processes",
    "unique_id": "b2c3d4e5-f6g7-8901-bcde-123456789014"
}

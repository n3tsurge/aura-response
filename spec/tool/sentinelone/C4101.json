{
    "id": "T0001.C4101",
    "ref": "tool:sentinelone:eradicate:remove-malware-from-host",
    "author": "n3tsurge",
    "created_on": "2025-07-15",
    "description": "This tool capability allows stakeholders to remove malware from hosts using SentinelOne's automated remediation and threat mitigation features. It provides comprehensive malware eradication through AI-powered threat response.\n\n## Workflow\n\n### How to Remove Malware via SentinelOne Console (GUI)\n\n1. **Log into the SentinelOne Management Console.**\n2. Navigate to **'Threats'** in the sidebar to view detected threats.\n3. Identify the malware threat requiring remediation:\n   - Review threat classification and severity\n   - Analyze threat details and affected files\n   - Check threat timeline and attack progression\n4. Select the threat entry and choose remediation actions:\n   - **'Mitigate'** - Automatic AI-powered remediation\n   - **'Quarantine'** - Isolate malicious files\n   - **'Kill Process'** - Terminate malicious processes\n   - **'Rollback'** - Undo malicious changes\n5. For advanced malware removal:\n   - Navigate to **'Deep Visibility'** for forensic analysis\n   - Use **'Event Search'** to identify all malware artifacts:\n     ```\n     event.type = 'File Creation' and tgt.file.path contains 'malware.exe'\n     event.type = 'Registry Key Create' and tgt.registry.path contains 'malware'\n     event.type = 'Process Creation' and src.process.name = 'malware.exe'\n     ```\n6. Apply comprehensive remediation:\n   - **File Remediation**: Delete/quarantine malicious files\n   - **Registry Cleanup**: Remove malicious registry entries\n   - **Process Termination**: Kill malicious processes\n   - **Network Isolation**: Contain affected endpoints\n7. Verify remediation success through re-scanning.\n8. Document remediation actions and restore normal operations.\n\n### Using SentinelOne API for Malware Removal\n\n```bash\n# Mitigate threat automatically\ncurl -X POST \"https://[console].sentinelone.net/web/api/v2.1/threats/mitigate\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"filter\": {\n      \"ids\": [\"threat-id-here\"]\n    }\n  }'\n\n# Quarantine malicious files\ncurl -X POST \"https://[console].sentinelone.net/web/api/v2.1/threats/actions/quarantine\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"filter\": {\n      \"ids\": [\"threat-id-here\"]\n    }\n  }'\n\n# Rollback malicious changes\ncurl -X POST \"https://[console].sentinelone.net/web/api/v2.1/threats/actions/rollback\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"filter\": {\n      \"ids\": [\"threat-id-here\"]\n    }\n  }'\n```\n\n### PowerQuery for Malware Artifact Analysis\n\n```sql\n# Identify all artifacts related to malware\nevent.type in ('File Creation', 'Process Creation', 'Registry Key Create') and (tgt.file.path contains 'malware' or src.process.name contains 'malware' or tgt.registry.path contains 'malware') | group ArtifactCount = count() by event.type, src.process.name | sort -ArtifactCount\n```\n\n### Automated Threat Response Queries\n\n```sql\n# Monitor remediation effectiveness\nevent.type = 'Threat Mitigation' and mitigation.status = 'Success' | group RemediationCount = count() by threat.name, mitigation.type | sort -RemediationCount\n\n# Verify threat elimination\nevent.type = 'File Creation' and tgt.file.path contains 'known-malware-name' and event.time > '2024-01-01T00:00:00Z' | project event.time, src.process.name, tgt.file.path, endpoint.name\n```\n\n### Post-Remediation Verification\n\n```sql\n# Confirm no remaining malicious processes\nevent.type = 'Process Creation' and src.process.name in ('malware.exe', 'trojan.exe', 'backdoor.exe') and event.time > 'last-remediation-time' | project event.time, src.process.name, src.process.cmdLine, endpoint.name\n```\n\nThis provides comprehensive malware eradication using SentinelOne's AI-powered threat response and S1QL 2.0 query language for complete threat elimination.",
    "friendly_name": "sentinelone-remove-malware-from-host",
    "title": "Remove Malware from Host",
    "unique_id": "e5f6g7h8-i9j0-1234-efgh-123456789017"
}

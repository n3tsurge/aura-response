{
    "id": "T0001.C3002",
    "ref": "tool:sentinelone:contain:block-network-traffic-by-process",
    "author": "n3tsurge",
    "created_on": "2025-07-15",
    "description": "This tool capability allows stakeholders to block network traffic by process using SentinelOne's containment and response features. It enables rapid isolation of suspicious processes to prevent data exfiltration or lateral movement.\n\n## Workflow\n\n### How to Block Network Traffic by Process via SentinelOne Console (GUI)\n\n1. **Log into the SentinelOne Management Console.**\n2. Navigate to **'Event Search'** to identify the target process:\n   ```\n   event.type = 'Process Creation' and src.process.name contains 'suspicious.exe'\n   event.type = 'IP Connect' and src.process.name = 'malware.exe'\n   ```\n3. Navigate to **'Agents'** or **'Endpoints'** view.\n4. Select the affected endpoint(s).\n5. Use **'Actions'** menu to apply containment:\n   - **Network Quarantine**: Isolates endpoint from network\n   - **Disconnect from Network**: Immediate network isolation\n   - **Custom Firewall Rules**: Block specific process traffic\n6. For process-specific blocking:\n   - Navigate to **'Threats'** or **'Activities'**\n   - Identify the process ID (PID) or process name\n   - Apply **'Kill Process'** action\n   - Enable **'Block Process'** to prevent restart\n7. Monitor containment status in **'Activities'** log.\n8. Verify network isolation using connectivity tests.\n\n### Using SentinelOne API for Process Network Blocking\n\n```bash\n# Quarantine endpoint to block all network traffic\ncurl -X POST \"https://[console].sentinelone.net/web/api/v2.1/agents/actions/disconnect\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"filter\": {\n      \"ids\": [\"agent-id-here\"]\n    }\n  }'\n\n# Kill and block specific process\ncurl -X POST \"https://[console].sentinelone.net/web/api/v2.1/agents/actions/kill-process\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"filter\": {\n      \"ids\": [\"agent-id-here\"]\n    },\n    \"data\": {\n      \"processName\": \"malware.exe\",\n      \"blockProcess\": true\n    }\n  }'\n```\n\n### PowerQuery for Process Network Activity Analysis\n\n```sql\nevent.type = 'IP Connect' and src.process.name contains 'suspicious' | group ConnectionCount = count(), DistinctIPs = estimate_distinct(dst.ip.address) by src.process.name, src.process.user | filter DistinctIPs > 5 | sort -ConnectionCount\n```\n\nThis provides comprehensive process-based network containment using SentinelOne's automated response capabilities for threat mitigation.",
    "friendly_name": "sentinelone-block-network-traffic-by-process",
    "title": "Block Network Traffic by Process",
    "unique_id": "a1b2c3d4-e5f6-7890-abcd-123456789013"
}

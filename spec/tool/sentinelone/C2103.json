{
    "id": "T0001.C2103",
    "ref": "tool:sentinelone:identify:list-network-connections",
    "author": "n3tsurge",
    "created_on": "2025-07-15",
    "description": "This tool capability allows stakeholders to identify and analyze network connections using SentinelOne's Event Search and Deep Visibility features. It provides comprehensive network monitoring for threat detection and incident response.\n\n## Workflow\n\n### How to List Network Connections via SentinelOne Console (GUI)\n\n1. **Log into the SentinelOne Management Console.**\n2. Navigate to **'Event Search'** in the sidebar.\n3. Use the **EDR** or **XDR** view for network connection analysis.\n4. Configure search queries to identify network activity:\n   ```\n   event.type = 'IP Connect'\n   event.type = 'IP Connect' and event.network.direction = 'OUTGOING'\n   event.type = 'IP Connect' and dst.port.number = 443\n   event.type = 'IP Connect' and dst.ip.address starts_with '10.'\n   ```\n5. Navigate to **'Deep Visibility'** for live network investigation:\n   - Select target endpoint(s)\n   - Use **'Network'** view for real-time connections\n   - Apply filters for specific connection criteria\n6. Analyze network connection data:\n   - `src.ip.address` - source IP address\n   - `dst.ip.address` - destination IP address\n   - `src.port.number` - source port\n   - `dst.port.number` - destination port\n   - `event.network.direction` - connection direction (INCOMING/OUTGOING)\n   - `event.network.protocol` - protocol (TCP/UDP/ICMP)\n   - `event.network.connectionStatus` - connection status\n   - `src.process.name` - process making connection\n   - `event.time` - timestamp of connection\n7. Use **PowerQuery** for advanced network analysis:\n   ```\n   event.type = 'IP Connect' | group ConnectionCount = count() by dst.ip.address, dst.port.number | sort -ConnectionCount\n   ```\n8. Apply **Threat Intelligence** overlays to identify malicious IPs.\n9. Export results for network security analysis.\n\n### Using SentinelOne API for Network Connection Analysis\n\n```bash\n# Query network connection events via API\ncurl -X GET \"https://[console].sentinelone.net/web/api/v2.1/cloud-funnel/events\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -G -d \"query=event.type = 'IP Connect'\" \\\n  -d \"limit=1000\"\n\n# Get live network connections from specific agent\ncurl -X GET \"https://[console].sentinelone.net/web/api/v2.1/agents/[agent-id]/network-connections\" \\\n  -H \"Authorization: ApiToken [your-token]\"\n```\n\n### PowerQuery for Advanced Network Connection Analysis\n\n```sql\nevent.type = 'IP Connect' and event.network.direction = 'OUTGOING' | group ConnectionCount = count(), DistinctPorts = estimate_distinct(dst.port.number) by dst.ip.address | filter DistinctPorts > 5 | sort -ConnectionCount\n```\n\n### Threat Hunting Network Queries\n\n```sql\n# Identify potential data exfiltration\nevent.type = 'IP Connect' and event.network.direction = 'OUTGOING' and dst.port.number in (21, 22, 25, 53, 80, 443, 993, 995) | group TransferCount = count() by src.process.name, dst.ip.address, dst.port.number | filter TransferCount > 100\n\n# Detect unusual internal network scanning\nevent.type = 'IP Connect' and dst.ip.address starts_with '192.168.' | group TargetCount = estimate_distinct(dst.ip.address) by src.ip.address, src.process.name | filter TargetCount > 20\n```\n\nThis provides comprehensive network connection visibility using SentinelOne's S1QL 2.0 query language for network security monitoring and threat detection.",
    "friendly_name": "sentinelone-list-network-connections",
    "title": "List Network Connections",
    "unique_id": "c3d4e5f6-g7h8-9012-cdef-123456789015"
}

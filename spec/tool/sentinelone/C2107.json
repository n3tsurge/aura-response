{
    "id": "T0001.C2107",
    "ref": "tool:sentinelone:identify:list-hosts-communicating-by-port",
    "author": "n3tsurge",
    "created_on": "2025-07-15",
    "description": "This tool capability allows stakeholders to identify hosts communicating over specific ports using SentinelOne's Deep Visibility network monitoring. It helps analyze port-based communication patterns and identify potential security threats.\n\n## Workflow\n\n### How to List Hosts Communicating by Port via SentinelOne Console (GUI)\n\n1. **Log into the SentinelOne Management Console.**\n2. Navigate to the **'Visibility'** tab and select **'Deep Visibility'**.\n3. Configure network event filters:\n   - Set event type to **'Network'**\n   - Use **'Port'** or **'DstPort'** filters to specify the target port\n   - Apply time range for the investigation period\n4. Create advanced queries for port-specific analysis:\n   ```\n   event.type = 'IP Connect' and dst.port = 443\n   event.type = 'IP Connect' and (dst.port = 80 or dst.port = 8080)\n   event.type = 'IP Connect' and src.port = 22\n   ```\n5. Analyze the results to identify:\n   - `Source Host IP` - hosts initiating connections\n   - `Destination Host IP` - target hosts\n   - `Port Number` - specific port being used\n   - `Protocol` - TCP/UDP protocol type\n   - `Process Name` - application making the connection\n   - `User Context` - user account associated with the process\n   - `Connection Frequency` - how often connections occur\n6. Use **'Group By'** functionality to aggregate results by:\n   - Source IP addresses\n   - Destination ports\n   - Process names\n7. Export findings using the **'Export'** button for reporting.\n8. Set up **'Custom Rules'** for ongoing monitoring of suspicious port activity.\n\n### Using SentinelOne API\n\n```bash\n# Query hosts communicating on specific port\ncurl -X GET \"https://[console].sentinelone.net/web/api/v2.1/dv/events\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -G -d \"eventTypes=ip\" \\\n  -d \"queryFilter=dst.port = 443\" \\\n  -d \"limit=1000\"\n```\n\nThis enables comprehensive port-based network traffic analysis for security investigations.",
    "friendly_name": "sentinelone-list-hosts-communicating-by-port",
    "title": "List Hosts Communicating by Port",
    "unique_id": "b2c3d4e5-f6g7-8901-bcde-f12345678901"
}

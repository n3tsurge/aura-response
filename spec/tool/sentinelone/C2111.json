{
    "id": "T0001.C2111",
    "ref": "tool:sentinelone:identify:collect-transferred-data",
    "author": "n3tsurge",
    "created_on": "2025-07-15",
    "description": "This tool capability allows stakeholders to collect and preserve transferred data using SentinelOne's forensic collection and file retrieval features. It enables secure collection of files for analysis while maintaining chain of custody.\n\n## Workflow\n\n### How to Collect Transferred Data via SentinelOne Console (GUI)\n\n1. **Log into the SentinelOne Management Console.**\n2. Navigate to the **'Endpoints'** tab and select the target endpoint.\n3. Use **'Remote Shell'** or **'File Manager'** for direct file access:\n   - Click on **'Actions'** > **'Remote Shell'**\n   - Navigate to file locations identified in transfer analysis\n   - Use commands to examine and collect files\n4. Leverage **'Forensic Collection'** capabilities:\n   - Navigate to **'Visibility'** > **'Deep Visibility'**\n   - Identify files of interest from transfer events\n   - Use **'Fetch File'** functionality to retrieve files\n5. For systematic collection:\n   - Create **'Custom Scripts'** for automated collection\n   - Use **'Ranger'** functionality for file system analysis\n   - Apply **'File Integrity Monitoring'** baselines\n6. Data collection process:\n   - `File Identification` - locate transferred files\n   - `Hash Verification` - generate file hashes for integrity\n   - `Metadata Collection` - capture file timestamps and attributes\n   - `Chain of Custody` - document collection process\n   - `Secure Storage` - store collected data securely\n7. Use **'Export'** functionality to download collected files.\n8. Generate **'Collection Reports'** for documentation.\n\n### Using SentinelOne API for Collection\n\n```bash\n# Fetch specific file from endpoint\ncurl -X POST \"https://[console].sentinelone.net/web/api/v2.1/agents/[agent-id]/actions/fetch-files\" \\\n  -H \"Authorization: ApiToken [your-token]\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"data\": {\n      \"files\": [\"/path/to/file.txt\"],\n      \"password\": \"collection-password\"\n    }\n  }'\n```\n\n### Remote Collection Commands\n\n```bash\n# Via Remote Shell\n# Calculate file hashes\nGet-FileHash -Path \"C:\\Users\\user\\Documents\\file.txt\" -Algorithm SHA256\n\n# Copy files to secure location\nCopy-Item \"C:\\temp\\suspicious.exe\" \"C:\\forensics\\\" -Force\n\n# Archive multiple files\nCompress-Archive -Path \"C:\\evidence\\*\" -DestinationPath \"C:\\collection.zip\"\n```\n\n!!! warning \"Chain of Custody\"\n    Ensure proper documentation of all collection activities including timestamps, file hashes, and personnel involved to maintain forensic integrity.\n\nThis provides secure and forensically sound data collection capabilities for incident response and legal proceedings.",
    "friendly_name": "sentinelone-collect-transferred-data",
    "title": "Collect Transferred Data",
    "unique_id": "e5f6g7h8-i9j0-1234-efgh-345678901234"
}

# Denial of Service (DDoS/DoS) Response

## Overview

This playbook outlines the steps to respond to Denial of Service (DoS) and Distributed Denial of Service (DDoS) attacks. It covers the different types of DoS attacks including volumetric network bandwidth attacks, resource exhaustion attacks, and protocol-based attacks. The playbook includes identification, containment, eradication, and recovery procedures to restore service availability and mitigate the impact of DoS attacks on the organization.

## DoS Attack Types

### Volumetric Attacks (Network Layer)
- **UDP Floods**: Overwhelming target with UDP packets
- **ICMP Floods**: Flooding with ICMP requests
- **TCP SYN Floods**: Exhausting connection resources
- **Amplification Attacks**: Using third-party services to amplify attack traffic

### Protocol Attacks (Transport Layer)
- **TCP State Exhaustion**: Consuming connection state tables
- **Fragmented Packet Attacks**: Exploiting packet reassembly processes
- **Slowloris**: Keeping connections open to exhaust server resources

### Application Layer Attacks (Layer 7)
- **HTTP Floods**: Overwhelming web servers with HTTP requests
- **DNS Query Floods**: Targeting DNS infrastructure
- **Application-specific attacks**: Targeting specific application vulnerabilities

## Workflow

### Identification

After initial report of service degradation or unavailability, the following actions should be taken to qualify and quantify the scope of the DoS attack.

1. **Monitor Network Traffic Patterns**
   - Access external and internal flow logs to identify abnormal traffic volumes
   - Analyze traffic sources, destinations, and protocols
   - Identify top source IP addresses and geographic origins

2. **Assess Service Impact**
   - Determine which services are affected and their criticality
   - Measure performance degradation and resource utilization
   - Identify if attack is volumetric, protocol-based, or application-layer

3. **Collect Attack Artifacts**
   - Gather source IP addresses involved in the attack
   - Identify attack patterns, packet types, and protocols used
   - Document attack vectors and methods employed
   - Collect evidence of amplification sources if applicable

4. **Analyze Attack Infrastructure**
   - Determine if attack is distributed (DDoS) or single-source (DoS)
   - Identify botnet indicators or coordinated attack patterns
   - Assess attack sophistication and likely attribution

5. **Quantify Attack Scale**
   - Measure attack traffic volume (requests per second, bandwidth consumed)
   - Determine attack duration and patterns
   - Assess whether attack exceeds organizational mitigation capacity

### Containment

1. **Implement Immediate Traffic Controls**
   - Block external IP addresses identified as attack sources
   - Block internal IP addresses if they are participating in the attack
   - Implement rate limiting on affected services and protocols

2. **Apply Network-Level Protections**
   - Block port-based external communication for attack vectors
   - Implement geographic IP blocking if attack originates from specific regions
   - Configure upstream provider filtering if available

3. **Enable Application-Level Defenses**
   - Activate web application firewall (WAF) protections
   - Implement challenge-response mechanisms (CAPTCHA)
   - Enable connection throttling and request queuing

4. **Scale Infrastructure Resources**
   - Activate auto-scaling for cloud-based services
   - Implement load balancing and traffic distribution
   - Engage content delivery network (CDN) services for traffic absorption

5. **Coordinate with Service Providers**
   - Contact Internet Service Provider (ISP) for upstream filtering
   - Engage DDoS mitigation service providers if available
   - Coordinate with hosting providers for additional protections

### Eradication

1. **Remove Persistent Attack Sources**
   - Maintain blocking of confirmed malicious IP addresses
   - Update firewall rules to prevent future attacks from same sources
   - Clean compromised internal systems participating in the attack

2. **Patch Vulnerabilities**
   - Address any application vulnerabilities exploited during the attack
   - Update network device configurations to prevent similar attacks
   - Implement additional monitoring for early detection

3. **Strengthen Defenses**
   - Deploy additional DDoS protection mechanisms
   - Configure automated response rules for similar attack patterns
   - Update incident response procedures based on lessons learned

### Recovery

1. **Restore Service Operations**
   - Gradually remove traffic restrictions once attack subsides
   - Monitor service performance and availability during recovery
   - Verify all critical services are functioning normally

2. **Unblock Legitimate Traffic**
   - Remove blocks on IP addresses confirmed as legitimate
   - Lift geographic restrictions if they were implemented
   - Restore normal connection limits and rate controls

3. **Validate System Integrity**
   - Confirm no systems were compromised during the attack
   - Verify data integrity and system configurations
   - Test disaster recovery and backup systems if they were activated

4. **Resume Normal Operations**
   - Return to standard monitoring and alerting configurations
   - Communicate service restoration to stakeholders
   - Document any permanent changes made to infrastructure

### Lessons Learned

1. **Analyze Attack Effectiveness**
   - Evaluate which mitigation techniques were most effective
   - Identify gaps in detection and response capabilities
   - Document attack timeline and organizational response

2. **Improve Preparedness**
   - Update DDoS response procedures based on experience
   - Enhance monitoring and alerting for similar attack patterns
   - Consider additional DDoS protection investments

3. **Strengthen Resilience**
   - Implement architectural changes to improve attack resistance
   - Develop relationships with DDoS mitigation service providers
   - Enhance staff training for DDoS incident response

4. **Update Threat Intelligence**
   - Share attack indicators with relevant information sharing communities
   - Update threat intelligence feeds with new attack patterns
   - Document attacker tactics, techniques, and procedures (TTPs)